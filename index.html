<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Victoria's Enigma</title>
<style>
body {
    margin: 0;
    font-family: 'Verdana', sans-serif;
    background: linear-gradient(120deg, #cfd9ff, #e2ebf0);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
}
.enigma-playground {
    width: 580px;
    max-width: 95%;
    background: #fefefe;
    border-radius: 14px;
    padding: 22px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.12);
    animation: slideFade 0.9s ease;
}
.card {
    background: #f3f6f9;
    border-radius: 9px;
    margin-bottom: 14px;
    padding: 14px;
    transition: transform 0.25s ease, box-shadow 0.25s ease;
}
.card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.09);
}
h1, h3 { text-align: center; margin-top: 0; }
.rotor-row { display: flex; justify-content: space-between; flex-wrap: wrap; gap: 5px; margin: 7px 0; }
.rotor-letters { display: flex; justify-content: center; gap: 9px; margin-top: 9px; }
textarea { width: 100%; height: 78px; border-radius: 6px; border: 1px solid #c4d0dd; padding: 7px; font-size: 14px; resize: none; }
select,input { padding:5px; border-radius:5px; border:1px solid #c4d0dd; font-size:14px; }
button {
    width: 100%;
    padding: 11px;
    border: none;
    border-radius: 8px;
    background-color: #2c5ddd;
    color: #fff;
    font-size: 15px;
    cursor: pointer;
    transition: background 0.3s ease, transform 0.2s ease;
}
button:hover { background-color: #1e42b0; transform: scale(1.025); }
@keyframes slideFade { from {opacity:0; transform:translateY(18px);} to {opacity:1; transform:translateY(0);} }
@media(max-width:500px){ h1 { font-size:18px; } .rotor-row{ flex-direction: column; align-items:flex-start; } .rotor-letters{ flex-direction: row; } textarea{ height:65px; } }
</style>
</head>
<body>

<div class="enigma-playground">

<h1>Victoria's Enigma Simulation</h1>

<div class="card">
<h3>Input</h3>
<div style="font-size:12px;color:rgba(0,0,0,0.44);text-align:center;margin-bottom:5px;">
To Decrypt, place encrypted text here use same rotor settings
</div>
<textarea id="messageText"></textarea>
</div>

<div class="card">
<h3>Rotor Setup</h3>
<div class="rotor-row">
<label>Left Rotor:</label>
<select id="rotorLeft"><option>I</option><option>II</option><option>III</option></select>
<label>Middle Rotor:</label>
<select id="rotorMiddle"><option>I</option><option>II</option><option>III</option></select>
<label>Right Rotor:</label>
<select id="rotorRight"><option>I</option><option>II</option><option>III</option></select>
</div>
<div class="rotor-letters">
<input id="leftRotorStart" value="A" maxlength="1">
<input id="middleRotorStart" value="A" maxlength="1">
<input id="rightRotorStart" value="A" maxlength="1">
</div>
</div>

<button onclick="runEnigma()">Encrypt / Decrypt</button>

<div class="card">
<h3>Output</h3>
<textarea id="cipherResult" readonly></textarea>
</div>

<script>
const ALPH = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
const ROTORSET = {
    I:"EKMFLGDQVZNTOWYHXUSPAIBRCJ",
    II:"AJDKSIRUXBLHWTMCQGZNPYFVOE",
    III:"BDFHJLCPRTXVZNYEIWGAKMUSQO"
};
const REFLECT = "YRUHQSLDPXNGOKMIEBFZCWVJAT";

function rotorEncrypt(letter, rotorPos, rotorMap){
    if(!ALPH.includes(letter)) return letter;
    let idx = ALPH.indexOf(letter);
    idx = ALPH.indexOf(rotorMap[0][(idx + rotorPos[0])%26]);
    idx = ALPH.indexOf(rotorMap[1][(idx + rotorPos[1])%26]);
    idx = ALPH.indexOf(rotorMap[2][(idx + rotorPos[2])%26]);
    idx = ALPH.indexOf(REFLECT[idx]);
    idx = (rotorMap[2].indexOf(ALPH[idx]) - rotorPos[2] + 26)%26;
    idx = (rotorMap[1].indexOf(ALPH[idx]) - rotorPos[1] + 26)%26;
    idx = (rotorMap[0].indexOf(ALPH[idx]) - rotorPos[0] + 26)%26;
    return ALPH[idx];
}

async function runEnigma(){
    let text = document.getElementById("messageText").value.toUpperCase().replace(/[^A-Z]/g,'');
    const output = document.getElementById("cipherResult");
    output.value = "";
    const rotors = [
        ROTORSET[document.getElementById("rotorLeft").value],
        ROTORSET[document.getElementById("rotorMiddle").value],
        ROTORSET[document.getElementById("rotorRight").value]
    ];
    let positions = [
        ALPH.indexOf(document.getElementById("leftRotorStart").value.toUpperCase()),
        ALPH.indexOf(document.getElementById("middleRotorStart").value.toUpperCase()),
        ALPH.indexOf(document.getElementById("rightRotorStart").value.toUpperCase())
    ];
    if(positions.some(p=>p===-1)){ alert("Rotor letters must be A-Z"); return; }
    const rotorNames = [
        document.getElementById("rotorLeft").value,
        document.getElementById("rotorMiddle").value,
        document.getElementById("rotorRight").value
    ];
    if(new Set(rotorNames).size<3){ alert("Each rotor must be unique"); return; }
    for(let c of text){
        positions[2]=(positions[2]+1)%26;
        if(positions[2]===0) positions[1]=(positions[1]+1)%26;
        if(positions[1]===0 && positions[2]===0) positions[0]=(positions[0]+1)%26;
        output.value += rotorEncrypt(c, positions, rotors);
        await new Promise(r=>setTimeout(r,70));
    }
}
</script>

</div>
</body>
</html>
